package Threading.JavaWorldThreadingCore.Part3;

/**
 * Created by chetan on 26/11/16.
 */
// ThreadInterruptionDemo.java
class ThreadInterruptionDemo
{
   public static void main (String [] args)
   {
      ThreadB thdb = new ThreadB ();
      thdb.setName ("B");
      ThreadA thda = new ThreadA (thdb);
      thda.setName ("A");
      thdb.start ();
      //System.out.println("!!"+Thread.currentThread().getName());//will be main till it is blocked
      thda.start ();

   }
}
class ThreadA extends Thread
{
   //By above statement it is clear that this thread is thread B which will get finally interrupted
   private Thread thdOther;
   ThreadA (Thread thdOther)
   {
      this.thdOther = thdOther;
   }
   public void run ()
   {

      int sleepTime = (int) (Math.random () * 10000);
      System.out.println (getName () + " sleeping for " + sleepTime +
                          " milliseconds.");
      try
      {
         //A gets sleep and now B will get its turn and as per output it will
         // run till it gets interrupted and the flag is set
         System.out.println(Thread.currentThread().getName()+" going to sleep");
         Thread.sleep (sleepTime);
      }
      catch (InterruptedException e)
      {
      }
      System.out.println (getName () + " waking up, interrupting other " +
                          "thread and terminating.");
      thdOther.interrupt ();
   }
}
//TODO
//when both thread sleeps why is not main thread awaking
class ThreadB extends Thread
{
   int count = 0;
   public void run ()
   {
      while (!isInterrupted ())
      {
         try
         {
            System.out.println(Thread.currentThread().getName()+" going to sleep");
            //Here one thing to note is that though B is sleeping it is sleeping
            // for a very short time in compare to A which slept for 10seconds
            //so B wakes up and till it gets interrupted it goes on
            Thread.sleep ((int) (Math.random () * 10));
         }
         catch (InterruptedException e)
         {
            System.out.println (getName () + " about to terminate...");
            // Because the Boolean flag in the consumer thread's thread
            // object is clear, we call interrupt() to set that flag.
            // As a result, the next consumer thread call to isInterrupted()
            // retrieves a true value, which causes the while loop statement
            // to terminate.
            interrupt ();
         }
         System.out.println (getName () + " " + count++);
      }
   }
}
/*

output


/usr/lib/jvm/java-7-oracle/bin/java -Didea.launcher.port=7532 -Didea.launcher.bin.path=/home/chetan/Downloads/idea-IU-162.1121.32/bin -Dfile.encoding=UTF-8 -classpath /usr/lib/jvm/java-7-oracle/jre/lib/charsets.jar:/usr/lib/jvm/java-7-oracle/jre/lib/deploy.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/dnsns.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/localedata.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/sunec.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/sunjce_provider.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/sunpkcs11.jar:/usr/lib/jvm/java-7-oracle/jre/lib/ext/zipfs.jar:/usr/lib/jvm/java-7-oracle/jre/lib/javaws.jar:/usr/lib/jvm/java-7-oracle/jre/lib/jce.jar:/usr/lib/jvm/java-7-oracle/jre/lib/jfr.jar:/usr/lib/jvm/java-7-oracle/jre/lib/jfxrt.jar:/usr/lib/jvm/java-7-oracle/jre/lib/jsse.jar:/usr/lib/jvm/java-7-oracle/jre/lib/management-agent.jar:/usr/lib/jvm/java-7-oracle/jre/lib/plugin.jar:/usr/lib/jvm/java-7-oracle/jre/lib/resources.jar:/usr/lib/jvm/java-7-oracle/jre/lib/rt.jar:/home/chetan/IdeaProjects/CoreJavaRepo/out/production/CoreJavaRepo:/home/chetan/Downloads/openutils-log4j-2.0.5.jar:/home/chetan/Downloads/apache-log4j-1.2.17/log4j-1.2.17.jar:/home/chetan/Downloads/idea-IU-162.1121.32/lib/idea_rt.jar com.intellij.rt.execution.application.AppMain Threading.JavaWorldThreadingCore.Part3.ThreadInterruptionDemo
A sleeping for 6743 milliseconds.
B 0
B 1
B 2
B 3
B 4
B 5
B 6
B 7
B 8
B 9
B 10
B 11
B 12
B 13
B 14
B 15
B 16
B 17
B 18
B 19
B 20
B 21
B 22
B 23
B 24
B 25
B 26
B 27
B 28
B 29
B 30
B 31
B 32
B 33
B 34
B 35
B 36
B 37
B 38
B 39
B 40
B 41
B 42
B 43
B 44
B 45
B 46
B 47
B 48
B 49
B 50
B 51
B 52
B 53
B 54
B 55
B 56
B 57
B 58
B 59
B 60
B 61
B 62
B 63
B 64
B 65
B 66
B 67
B 68
B 69
B 70
B 71
B 72
B 73
B 74
B 75
B 76
B 77
B 78
B 79
B 80
B 81
B 82
B 83
B 84
B 85
B 86
B 87
B 88
B 89
B 90
B 91
B 92
B 93
B 94
B 95
B 96
B 97
B 98
B 99
B 100
B 101
B 102
B 103
B 104
B 105
B 106
B 107
B 108
B 109
B 110
B 111
B 112
B 113
B 114
B 115
B 116
B 117
B 118
B 119
B 120
B 121
B 122
B 123
B 124
B 125
B 126
B 127
B 128
B 129
B 130
B 131
B 132
B 133
B 134
B 135
B 136
B 137
B 138
B 139
B 140
B 141
B 142
B 143
B 144
B 145
B 146
B 147
B 148
B 149
B 150
B 151
B 152
B 153
B 154
B 155
B 156
B 157
B 158
B 159
B 160
B 161
B 162
B 163
B 164
B 165
B 166
B 167
B 168
B 169
B 170
B 171
B 172
B 173
B 174
B 175
B 176
B 177
B 178
B 179
B 180
B 181
B 182
B 183
B 184
B 185
B 186
B 187
B 188
B 189
B 190
B 191
B 192
B 193
B 194
B 195
B 196
B 197
B 198
B 199
B 200
B 201
B 202
B 203
B 204
B 205
B 206
B 207
B 208
B 209
B 210
B 211
B 212
B 213
B 214
B 215
B 216
B 217
B 218
B 219
B 220
B 221
B 222
B 223
B 224
B 225
B 226
B 227
B 228
B 229
B 230
B 231
B 232
B 233
B 234
B 235
B 236
B 237
B 238
B 239
B 240
B 241
B 242
B 243
B 244
B 245
B 246
B 247
B 248
B 249
B 250
B 251
B 252
B 253
B 254
B 255
B 256
B 257
B 258
B 259
B 260
B 261
B 262
B 263
B 264
B 265
B 266
B 267
B 268
B 269
B 270
B 271
B 272
B 273
B 274
B 275
B 276
B 277
B 278
B 279
B 280
B 281
B 282
B 283
B 284
B 285
B 286
B 287
B 288
B 289
B 290
B 291
B 292
B 293
B 294
B 295
B 296
B 297
B 298
B 299
B 300
B 301
B 302
B 303
B 304
B 305
B 306
B 307
B 308
B 309
B 310
B 311
B 312
B 313
B 314
B 315
B 316
B 317
B 318
B 319
B 320
B 321
B 322
B 323
B 324
B 325
B 326
B 327
B 328
B 329
B 330
B 331
B 332
B 333
B 334
B 335
B 336
B 337
B 338
B 339
B 340
B 341
B 342
B 343
B 344
B 345
B 346
B 347
B 348
B 349
B 350
B 351
B 352
B 353
B 354
B 355
B 356
B 357
B 358
B 359
B 360
B 361
B 362
B 363
B 364
B 365
B 366
B 367
B 368
B 369
B 370
B 371
B 372
B 373
B 374
B 375
B 376
B 377
B 378
B 379
B 380
B 381
B 382
B 383
B 384
B 385
B 386
B 387
B 388
B 389
B 390
B 391
B 392
B 393
B 394
B 395
B 396
B 397
B 398
B 399
B 400
B 401
B 402
B 403
B 404
B 405
B 406
B 407
B 408
B 409
B 410
B 411
B 412
B 413
B 414
B 415
B 416
B 417
B 418
B 419
B 420
B 421
B 422
B 423
B 424
B 425
B 426
B 427
B 428
B 429
B 430
B 431
B 432
B 433
B 434
B 435
B 436
B 437
B 438
B 439
B 440
B 441
B 442
B 443
B 444
B 445
B 446
B 447
B 448
B 449
B 450
B 451
B 452
B 453
B 454
B 455
B 456
B 457
B 458
B 459
B 460
B 461
B 462
B 463
B 464
B 465
B 466
B 467
B 468
B 469
B 470
B 471
B 472
B 473
B 474
B 475
B 476
B 477
B 478
B 479
B 480
B 481
B 482
B 483
B 484
B 485
B 486
B 487
B 488
B 489
B 490
B 491
B 492
B 493
B 494
B 495
B 496
B 497
B 498
B 499
B 500
B 501
B 502
B 503
B 504
B 505
B 506
B 507
B 508
B 509
B 510
B 511
B 512
B 513
B 514
B 515
B 516
B 517
B 518
B 519
B 520
B 521
B 522
B 523
B 524
B 525
B 526
B 527
B 528
B 529
B 530
B 531
B 532
B 533
B 534
B 535
B 536
B 537
B 538
B 539
B 540
B 541
B 542
B 543
B 544
B 545
B 546
B 547
B 548
B 549
B 550
B 551
B 552
B 553
B 554
B 555
B 556
B 557
B 558
B 559
B 560
B 561
B 562
B 563
B 564
B 565
B 566
B 567
B 568
B 569
B 570
B 571
B 572
B 573
B 574
B 575
B 576
B 577
B 578
B 579
B 580
B 581
B 582
B 583
B 584
B 585
B 586
B 587
B 588
B 589
B 590
B 591
B 592
B 593
B 594
B 595
B 596
B 597
B 598
B 599
B 600
B 601
B 602
B 603
B 604
B 605
B 606
B 607
B 608
B 609
B 610
B 611
B 612
B 613
B 614
B 615
B 616
B 617
B 618
B 619
B 620
B 621
B 622
B 623
B 624
B 625
B 626
B 627
B 628
B 629
B 630
B 631
B 632
B 633
B 634
B 635
B 636
B 637
B 638
B 639
B 640
B 641
B 642
B 643
B 644
B 645
B 646
B 647
B 648
B 649
B 650
B 651
B 652
B 653
B 654
B 655
B 656
B 657
B 658
B 659
B 660
B 661
B 662
B 663
B 664
B 665
B 666
B 667
B 668
B 669
B 670
B 671
B 672
B 673
B 674
B 675
B 676
B 677
B 678
B 679
B 680
B 681
B 682
B 683
B 684
B 685
B 686
B 687
B 688
B 689
B 690
B 691
B 692
B 693
B 694
B 695
B 696
B 697
B 698
B 699
B 700
B 701
B 702
B 703
B 704
B 705
B 706
B 707
B 708
B 709
B 710
B 711
B 712
B 713
B 714
B 715
B 716
B 717
B 718
B 719
B 720
B 721
B 722
B 723
B 724
B 725
B 726
B 727
B 728
B 729
B 730
B 731
B 732
B 733
B 734
B 735
B 736
B 737
B 738
B 739
B 740
B 741
B 742
B 743
B 744
B 745
B 746
B 747
B 748
B 749
B 750
B 751
B 752
B 753
B 754
B 755
B 756
B 757
B 758
B 759
B 760
B 761
B 762
B 763
B 764
B 765
B 766
B 767
B 768
B 769
B 770
B 771
B 772
B 773
B 774
B 775
B 776
B 777
B 778
B 779
B 780
B 781
B 782
B 783
B 784
B 785
B 786
B 787
B 788
B 789
B 790
B 791
B 792
B 793
B 794
B 795
B 796
B 797
B 798
B 799
B 800
B 801
B 802
B 803
B 804
B 805
B 806
B 807
B 808
B 809
B 810
B 811
B 812
B 813
B 814
B 815
B 816
B 817
B 818
B 819
B 820
B 821
B 822
B 823
B 824
B 825
B 826
B 827
B 828
B 829
B 830
B 831
B 832
B 833
B 834
B 835
B 836
B 837
B 838
B 839
B 840
B 841
B 842
B 843
B 844
B 845
B 846
B 847
B 848
B 849
B 850
B 851
B 852
B 853
B 854
B 855
B 856
B 857
B 858
B 859
B 860
B 861
B 862
B 863
B 864
B 865
B 866
B 867
B 868
B 869
B 870
B 871
B 872
B 873
B 874
B 875
B 876
B 877
B 878
B 879
B 880
B 881
B 882
B 883
B 884
B 885
B 886
B 887
B 888
B 889
B 890
B 891
B 892
B 893
B 894
B 895
B 896
B 897
B 898
B 899
B 900
B 901
B 902
B 903
B 904
B 905
B 906
B 907
B 908
B 909
B 910
B 911
B 912
B 913
B 914
B 915
B 916
B 917
B 918
B 919
B 920
B 921
B 922
B 923
B 924
B 925
B 926
B 927
B 928
B 929
B 930
B 931
B 932
B 933
B 934
B 935
B 936
B 937
B 938
B 939
B 940
B 941
B 942
B 943
B 944
B 945
B 946
B 947
B 948
B 949
B 950
B 951
B 952
B 953
B 954
B 955
B 956
B 957
B 958
B 959
B 960
B 961
B 962
B 963
B 964
B 965
B 966
B 967
B 968
B 969
B 970
B 971
B 972
B 973
B 974
B 975
B 976
B 977
B 978
B 979
B 980
B 981
B 982
B 983
B 984
B 985
B 986
B 987
B 988
B 989
B 990
B 991
B 992
B 993
B 994
B 995
B 996
B 997
B 998
B 999
B 1000
B 1001
B 1002
B 1003
B 1004
B 1005
B 1006
B 1007
B 1008
B 1009
B 1010
B 1011
B 1012
B 1013
B 1014
B 1015
B 1016
B 1017
B 1018
B 1019
B 1020
B 1021
B 1022
B 1023
B 1024
B 1025
B 1026
B 1027
B 1028
B 1029
B 1030
B 1031
B 1032
B 1033
B 1034
B 1035
B 1036
B 1037
B 1038
B 1039
B 1040
B 1041
B 1042
B 1043
B 1044
B 1045
B 1046
B 1047
B 1048
B 1049
B 1050
B 1051
B 1052
B 1053
B 1054
B 1055
B 1056
B 1057
B 1058
B 1059
B 1060
B 1061
B 1062
B 1063
B 1064
B 1065
B 1066
B 1067
B 1068
B 1069
B 1070
B 1071
B 1072
B 1073
B 1074
B 1075
B 1076
B 1077
B 1078
B 1079
B 1080
B 1081
B 1082
B 1083
B 1084
B 1085
B 1086
B 1087
B 1088
B 1089
B 1090
B 1091
B 1092
B 1093
B 1094
B 1095
B 1096
B 1097
B 1098
B 1099
B 1100
B 1101
B 1102
B 1103
B 1104
B 1105
B 1106
B 1107
B 1108
B 1109
B 1110
B 1111
B 1112
B 1113
B 1114
B 1115
B 1116
B 1117
B 1118
B 1119
B 1120
B 1121
B 1122
B 1123
B 1124
B 1125
B 1126
B 1127
B 1128
B 1129
B 1130
B 1131
B 1132
B 1133
B 1134
B 1135
B 1136
B 1137
B 1138
B 1139
B 1140
B 1141
B 1142
B 1143
B 1144
B 1145
B 1146
B 1147
B 1148
B 1149
B 1150
B 1151
B 1152
B 1153
B 1154
B 1155
B 1156
B 1157
B 1158
B 1159
B 1160
B 1161
B 1162
B 1163
B 1164
B 1165
B 1166
B 1167
B 1168
B 1169
B 1170
B 1171
B 1172
B 1173
B 1174
B 1175
B 1176
B 1177
B 1178
B 1179
B 1180
B 1181
B 1182
B 1183
B 1184
B 1185
B 1186
B 1187
B 1188
B 1189
B 1190
B 1191
B 1192
B 1193
B 1194
B 1195
B 1196
B 1197
B 1198
B 1199
B 1200
B 1201
B 1202
B 1203
B 1204
B 1205
B 1206
B 1207
B 1208
B 1209
B 1210
B 1211
B 1212
B 1213
B 1214
B 1215
B 1216
B 1217
B 1218
B 1219
B 1220
B 1221
B 1222
B 1223
B 1224
B 1225
B 1226
B 1227
B 1228
B 1229
B 1230
B 1231
B 1232
B 1233
B 1234
B 1235
B 1236
B 1237
B 1238
B 1239
B 1240
B 1241
B 1242
B 1243
B 1244
B 1245
B 1246
B 1247
B 1248
B 1249
B 1250
B 1251
B 1252
B 1253
B 1254
B 1255
B 1256
B 1257
B 1258
B 1259
B 1260
B 1261
B 1262
B 1263
B 1264
B 1265
B 1266
B 1267
B 1268
B 1269
B 1270
B 1271
B 1272
B 1273
B 1274
B 1275
B 1276
B 1277
B 1278
B 1279
B 1280
B 1281
B 1282
B 1283
B 1284
B 1285
B 1286
B 1287
B 1288
B 1289
B 1290
B 1291
B 1292
B 1293
B 1294
B 1295
B 1296
B 1297
B 1298
B 1299
B 1300
B 1301
B 1302
B 1303
B 1304
B 1305
B 1306
B 1307
B 1308
B 1309
B 1310
B 1311
B 1312
B 1313
B 1314
B 1315
B 1316
B 1317
B 1318
B 1319
B 1320
B 1321
B 1322
B 1323
B 1324
B 1325
B 1326
B 1327
B 1328
B 1329
B 1330
B 1331
B 1332
B 1333
B 1334
B 1335
B 1336
B 1337
B 1338
B 1339
B 1340
B 1341
B 1342
B 1343
B 1344
B 1345
B 1346
B 1347
B 1348
B 1349
B 1350
B 1351
B 1352
B 1353
B 1354
B 1355
B 1356
B 1357
B 1358
B 1359
B 1360
B 1361
B 1362
B 1363
B 1364
B 1365
B 1366
B 1367
B 1368
B 1369
B 1370
B 1371
B 1372
B 1373
B 1374
B 1375
B 1376
B 1377
B 1378
B 1379
B 1380
B 1381
B 1382
B 1383
B 1384
B 1385
B 1386
B 1387
B 1388
B 1389
B 1390
B 1391
B 1392
B 1393
B 1394
B 1395
B 1396
B 1397
B 1398
B 1399
B 1400
B 1401
B 1402
B 1403
B 1404
B 1405
B 1406
B 1407
B 1408
B 1409
B 1410
B 1411
B 1412
B 1413
B 1414
B 1415
B 1416
B 1417
B 1418
B 1419
B 1420
B 1421
B 1422
B 1423
B 1424
B 1425
B 1426
B 1427
B 1428
B 1429
B 1430
B 1431
B 1432
B 1433
B 1434
B 1435
A waking up, interrupting other thread and terminating.
B about to terminate...
B 1436

Process finished with exit code 0

 */